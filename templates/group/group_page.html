{% extends "base.html" %}
{% block script %}
<script type="text/javascript">
	$(document).ready(function(){
			$('#db_add').click(function(e){
				window.location.href=document.URL + "/db_make";
			});

			$('.approval').click(function(e){
				row=$(this).parent().parent();	
				$.ajax({
					type: "GET",
					url: document.URL + "/" + $(this).parent().parent().children('td:nth-child(2)').html() + "/s",
					success: function(data){
						row.remove();
					},
					error: function(xhr, ajaxOptions, errorThrown){
					}
				});
				return false;
			});

			$('.delete').click(function(e){
				c=confirm("삭제 하시겠습니까?");
				if (c == true){
					name=$(this).parent().parent().children('td:nth-child(1)').html();
					row=$(this).parent().parent();
					$.ajax({
						type: "POST",
						url: document.URL + "/db_delete",
						data: {'name': name},
						success: function(data){
							alert("성공적으로 " + name + " DB를 삭제했습니다.");
							row.remove();
						},
						error: function(xhr, ajaxOptions, errorThrown){
						}
					});
					return false;
				}
			});
			
			$('.delete').hide();

			$('#delete_appear').click(function(e){
				if ($(this).html() == "수정")
					$(this).html('완료');
				else
					$(this).html('수정');
				$('.delete').toggle();
				$('.delete_group').toggle();
			});



			$('.denial').click(function(e){
				row=$(this).parent().parent();	
				$.ajax({
					type: "GET",
					url: document.URL + "/" + $(this).parent().parent().children('td:nth-child(2)').html() + "/f",
					success: function(data){
						row.remove();
					},
					error: function(xhr, ajaxOptions, errorThrown){
					}
				});
				return false;
			});

			$('.db_redirect').click(function(e){
				window.location.href=document.URL + "/" + $(this).html();
			});
		});
</script>
{% endblock %}
{% block wrapper %}
<<<<<<< HEAD

<div class="container-fluid">
	<div class="row-fluid">
		<div class="span2">
			<div id="memfield" class="well sidebar-nav">
				<ul class="nav nav-list">
					<li class="nav-header">그룹 구성원:&nbsp;{{ g.num_member }}명</li><br>
                                        <li id = "administrator" class = "memclass">
                                                <strong>관리자</strong>
                                                <ul class="nav nav-list">
                                                        {% for member in admin %}
                                                        <li>{{ member.user.first_name }}</li>   <!-- 임시적으로 id를 표시하도록 한다. -->
                                                        {% endfor %}
                                                </ul>
                                        </li><br>
                                        <li id = "user" class = "memclass">
                                                <strong>일반 사용자</strong>
                                                <ul class="nav nav-list">
                                                        {% for member in normal %}
                                                        <li>{{ member.user.first_name }}</li>
                                                        {% endfor %}
                                                </ul>
                                        </li>
				</ul>
			</div>
		</div>
		<div class="span10">
			{% if m.status == 0 %}
			<div id = "permission">
				<table id = "permitdb" align="center" class="table table-hover table-striped">
					<thead>
						<tr>
							<td style="width: 100px">이름</td>
							<td style="width: 100px">ID</td>
							<td style="width: 100px">메세지</td>
							<td style="width: 100px">승인</td>
							<td style="width: 100px">거부</td>
						</tr>
					</thead>
					<tbody>
					{% for r in join_req %}
						<tr>
							<td>{{ r.user.first_name }}</td>
							<td>{{ r.user.username }}</td>
							<td>{{ r.message }}</td>
							<td>
								<button class="approval">승인</button>
							</td>
							<td>
								<button class="denial">거부</button>
							</td>
						</tr>
					{% endfor %}
					</tbody>
				</table>

			</div>
			{% endif %}

			<div id = "dbfield">	
				<table id = "mydb" align="center" class="table table-hover table-striped">
					<thead>
						<tr>
							<td style="width: 100px">DB명</td>
							<td style="width: 100px">DB유형</td>
							<td style="width: 100px">선택</td>
						</tr>
					</thead>
					<tbody>
						{% for d in db %}
						<tr>
							<td class="db_redirect">{{ d.name }}</td>
							<td>{{ d.dbtype }}</td>
							<td><input type="button" class="delete" value="삭제"></td>
						</tr>
						{% endfor %}
					</tbody>
				</table>
				<div id="buttons">	
					<span id = "adddb"><button id="db_add" class="btn">새 DB 추가</button></span>
					<span id = "editdb"><button class="btn">수정</button></span>  <!--수정을 클릭하면 완료로 글자 바뀜-->
				</div>
			</div>


			{% if private == "false" %}
                	<div id="memfield">
                        <aside>
                                <span id="gpmember">그룹 멤버:</span>
                                <span id="numofmem">{{ g.num_member }} </span>
                                <ol>
                                        <li id="administrator" class = "memclass">
                                                <strong>관리자</strong>
                                                <ul>
                                                        {% for member in admin %}
                                                        <li>{{ member.user.first_name }}</li>   <!-- 임시적으로 id를 표시하도록 한다. -->
                                                        {% endfor %}
                                                        <!--
                                                        <li>김진명</li>
                                                        <li>안용주</li>
                                                        <li>박성준</li>
                                                        -->
                                                </ul>
                                        </li>
                                        <li id="user" class = "memclass">
                                                <strong>일반 사용자</strong>
                                                <ul>
                                                        {% for member in normal %}
                                                        <li>{{ member.user.first_name }}</li>
                                                        {% endfor %}
                                                        <!--
                                                        <li>이현민</li>
                                                        <li>김도연</li>
                                                        <li>최준혁</li>
                                                        <li>이선호</li>
                                                        -->
                                                </ul>
                                        </li>
                                </ol>
                        </aside>
                	</div>
                	{% endif %}
		</div>
	</div>
</div>
{% endblock %}


